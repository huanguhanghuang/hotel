<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="assets/css/amazeui.min.css">
    <script src="assets/js/jquery.min.js"></script>
    <script  src="assets/js/amazeui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" type="text/css" href="css/report-form.css">
</head>
<body>
    <header class="am-topbar">
    <h1 class="am-topbar-brand" style="margin-left:20%;margin-right:2%;">
        <a href="#" style="color:white;">酒店管理系统</a>
    </h1>

    <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#doc-topbar-collapse'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>

    <div class="am-collapse am-topbar-collapse am-topbar-inverse" id="doc-topbar-collapse">
        <ul class="am-nav am-nav-pills am-topbar-nav">
            <li class="am-active"><a href="room-status.html">房态图</a></li>
            <li><a href="guest.html">客人</a></li>
            <li><a href="vip.html">会员</a></li>
            <li><a href="company.html">协议单位</a></li>
            <li><a href="report-forms.html">报表</a></li>
            <li><a href="stock.html">库存</a></li>
            <li><a href="options.html">设置</a></li>
        </ul>
    </div>
</header>
    <section id="report">
        <div id="bra">
            <button class="am-btn am-btn-secondary" >营业日报表</button>
            <button class="am-btn am-btn-secondary" >营业月报表</button>
            <button class="am-btn am-btn-secondary" >营业汇总表</button>
        </div>
        <div id="main" style="width: 90%;float: right;">
            <div id="show">
                <div id="myDiv">  
                    <table id="tableExcel" width="100%" border="1" cellspacing="0" cellpadding="0">  
                        <tr>  
                            <td colspan="5" align="center">斯纳格田园酒店(绵阳)营业月报表</td>  
                        </tr>  
                        <tr>  
                            <td>列标题1</td>  
                            <td>列标题2</td>  
                            <td>类标题3</td>  
                            <td>列标题4</td>  
                            <td>列标题5</td>  
                        </tr>  
                        <tr>  
                            <td>aaa</td>  
                            <td>bbb</td>  
                            <td>ccc</td>  
                            <td>ddd</td>  
                            <td>eee</td>  
                        </tr>  
                        <tr>  
                            <td>AAA</td>  
                            <td>BBB</td>  
                            <td>CCC</td>  
                            <td>DDD</td>  
                            <td>EEE</td>  
                        </tr>  
                        <tr>  
                            <td>FFF</td>  
                            <td>GGG</td>  
                            <td>HHH</td>  
                            <td>III</td>  
                            <td>JJJ</td>  
                        </tr>  
                    </table>  
                </div>
                <div>  
                     <button type="button" onclick="method5('tableExcel')" class="am-btn am-btn-secondary">导出Excel</button>
                     <button type="button" onclick="ButtonClicked('myDiv');" name="HelloButton" class="am-btn am-btn-secondary">打印</button>   
                </div>   
            </div>
        </div>
    </section>
    <footer>
        <div id="left">
            <span class="foot">酒店名称：斯纳格田园酒店</span>
            <span class="foot">用户名：18990180707</span>
            <span class="foot">班次：早班</span>
        </div>

        <div id="right">
            <a href="#" class="foot" data-am-modal="{target: '#doc-modal-shiftexchange', closeViaDimmer: 0, width:1200, height:800}">交班</a>
            <span>|</span>
            <a href="#" class="foot">版本更新</a>
            <span>|</span>
            <a href="#" class="foot">退出</a>
            <span>|</span>
            <a href="#" class="foot"><img src="image/message.gif"></a>
        </div>
        <div class="am-modal am-modal-no-btn" tabindex="-1" id="doc-modal-shiftexchange">
            <div class="am-modal-dialog">
                <div class="am-modal-hd">交班报表
                    <a href="javascript: void(0)" class="am-close am-close-spin" data-am-modal-close>&times;</a>
                </div>
                <div class="am-modal-bd">
                    <span  style="float: left" >本班时间:</span>
                    <table class="am-table am-table-bordered">
                        <tr class="am-primary">
                            <td>项目</td>
                            <td colspan="11">支付方式</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>现金</td>
                            <td>银行卡</td>
                            <td>网上支付</td>
                            <td>储值卡</td>
                            <td>微信支付</td>
                            <td>协议挂账</td>
                            <td>支付宝扫码</td>
                            <td>携程</td>
                            <td>糯米</td>
                            <td>美团</td>
                            <td>盖网</td>
                            <td>小计</td>
                        </tr>
                        <tr>
                            <td>订金</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>押金</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>非住客帐</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>结账收款</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>结账退款</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>卡充值</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>消费付现</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>挂账结算</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>协议单位充值</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>合计</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                    <span  style="float: left">交班人签字</span>
                    <button class="am-btn am-btn-secondary">交班</button>
                    <button class="am-btn am-btn-secondary">打印</button>


                </div>
            </div>
        </div><!--交班报表的模态窗口-->

    </footer>
    <script language="JavaScript" type="text/javascript">  
        var idTmr;  
        function  getExplorer() {  
            var explorer = window.navigator.userAgent ;  
            //ie  
            if (explorer.indexOf("MSIE") >= 0) {  
                return 'ie';  
            }  
            //firefox  
            else if (explorer.indexOf("Firefox") >= 0) {  
                return 'Firefox';  
            }  
            //Chrome  
            else if(explorer.indexOf("Chrome") >= 0){  
                return 'Chrome';  
            }  
            //Opera  
            else if(explorer.indexOf("Opera") >= 0){  
                return 'Opera';  
            }  
            //Safari  
            else if(explorer.indexOf("Safari") >= 0){  
                return 'Safari';  
            }  
        }  
        function method5(tableid) {  
            if(getExplorer()=='ie')  
            {  
                var curTbl = document.getElementById(tableid);  
                var oXL = new ActiveXObject("Excel.Application");  
                var oWB = oXL.Workbooks.Add();  
                var xlsheet = oWB.Worksheets(1);  
                var sel = document.body.createTextRange();  
                sel.moveToElementText(curTbl);  
                sel.select();  
                sel.execCommand("Copy");  
                xlsheet.Paste();  
                oXL.Visible = true;  
  
                try {  
                    var fname = oXL.Application.GetSaveAsFilename("Excel.xls", "Excel Spreadsheets (*.xls), *.xls");  
                } catch (e) {  
                    print("Nested catch caught " + e);  
                } finally {  
                    oWB.SaveAs(fname);  
                    oWB.Close(savechanges = false);  
                    oXL.Quit();  
                    oXL = null;  
                    idTmr = window.setInterval("Cleanup();", 1);  
                }  
  
            }  
            else  
            {  
                tableToExcel(tableid)  
            }  
        }  
        function Cleanup() {  
            window.clearInterval(idTmr);  
            CollectGarbage();  
        }  
        var tableToExcel = (function() {  
            var uri = 'data:application/vnd.ms-excel;base64,',  
                    template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',  
                    base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },  
                    format = function(s, c) {  
                        return s.replace(/{(\w+)}/g,  
                                function(m, p) { return c[p]; }) }  
            return function(table, name) {  
                if (!table.nodeType) table = document.getElementById(table)  
                var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}  
                window.location.href = uri + base64(format(template, ctx))  
            }  
        })()  
        $('#bra button:eq(0)').click(function () {
            window.location.reload();
        }).next().click(function () {
            $('#main').load('report-forms/month-form.html')
        }).next().click(function () {
           $('#main').load('report-forms/summary-form.html')
        })

        function ButtonClicked(position) {
            var tags = document.getElementsByTagName('button');
            for (i=0; i<tags.length; i++)
            {
                tags.item(i).style.display = 'none';
            }
            document.getElementById(position).style.display = 'block';
            window.print();
            for (i=0; i<tags.length; i++)
            {
                tags.item(i).style.display = 'block';
            }
            window.location.reload(); 
        }
    </script>  
</body>
</html>